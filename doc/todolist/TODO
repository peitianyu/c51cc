✔ 完成语法功能整理工作 [](./支持语法功能.md) @done(26-01-12 17:14)
✘ 拆解出51单片机需要切实添加的语法 @cancelled(26-01-15 10:13)
✔ 完善struct, union接口 @done(26-01-16 10:36)
    ✔ 添加struct union定义ast, 并展示 @done(26-01-12 21:54)
    ✔ struct顺序初始化, {0};初始化 @done(26-01-13 17:50)
    ✔ struct指定初始化器初始化 @done(26-01-13 17:50)
    ✔ 位域的支持 @done(26-01-16 10:36)
✔ 补全变量初始化 @done(26-01-16 11:22)
    ✔ char int 初始化 @done(26-01-13 22:49)
    ✔ float double初始化 @done(26-01-13 22:49)
    ✔ arr初始化 @done(26-01-16 11:22)
        ✔ 多维数组序列初始化 @done(26-01-16 11:22)
    ✔ ptr初始化 @done(26-01-13 22:49)
✔ 添加对于bool的支持 (这部分在c51中表示为bit) @done(26-01-15 13:20)
✔ 添加enum类型支持 @done(26-01-15 18:03)
✔ 二元运算左右符号推导输出符号 @done(26-01-13 22:51)
✔ 增加更加清晰的调试打印 @done(26-01-14 21:21)
✔ 添加类型修饰 const volatile restrict unsigned register static extern typedef修饰符支持 @done(26-01-14 17:47)
✔ 添加函数限定 inline noreturn @done(26-01-14 17:51)
✔ 添加typedef类型检测 @done(26-01-15 18:46)
✔ 添加var与init的检查 @done(26-01-15 11:39)
✔ 添加常量类型支持 (16进制, 2进制) @done(26-01-14 21:52)
✔ 添加变量重复定义, 未定义检测 @done(26-01-15 12:34)
✔ 添加函数重复定义与未声明检测 @done(26-01-15 12:51)
✘ 添加sfr sfr16 sbit bit data xdata idata bdata code reentrant interrupt using等修饰符支持 @cancelled(26-01-14 17:52)
✔ 添加控制语句 while do-while continue break  else if @done(26-01-15 22:29)
✔ 添加switch/case/default语句 @done(26-01-16 08:33)
    ✔ 添加case 1 ... 9:语法支持 @done(26-01-16 09:13)
✔ 添加goto语句 @done(26-01-15 23:04)
✔ 添加判断>= <= !=支持 @done(26-01-16 11:01)
✔ 添加对于void foo(void){}语句支持 @done(26-01-12 21:00)
✔ ~ ^ @done(26-01-16 16:16)
✔ (type)cast @done(26-01-16 16:32)

# 2026-01-28 语法修复汇总
✔ 一元运算符支持 @done(26-01-28 15:20)
    ✔ 一元正号 (+a) - 直接返回操作数 @done(26-01-28 15:20)
    ✔ 一元负号 (-a) - 转换为 0 - a @done(26-01-28 15:20)
    ✔ 前置自增 (++a) - 检查左值并创建一元操作节点 @done(26-01-28 15:20)
    ✔ 前置自减 (--a) - 检查左值并创建一元操作节点 @done(26-01-28 15:20)
✔ 逗号分隔声明支持 @done(26-01-28 15:20)
    ✔ 多变量同时声明 (int a = 1, b = 2;) @done(26-01-28 15:20)
    ✔ 添加 read_decl_multi() 函数处理多个变量 @done(26-01-28 15:20)
✔ 数组名转指针支持 @done(26-01-28 15:20)
    ✔ 数组名可赋值给指针变量 (int *p = arr) @done(26-01-28 15:20)
    ✔ 自动将数组类型转换为指针类型 @done(26-01-28 15:20)
✔ 函数指针参数支持 @done(26-01-28 15:20)
    ✔ 支持 type (*name)(params) 语法 @done(26-01-28 15:20)
    ✔ 支持函数指针变量调用 @done(26-01-28 15:20)
✔ 递归调用支持 @done(26-01-28 15:20)
    ✔ 先创建函数声明再解析函数体 @done(26-01-28 15:20)
✔ 字符串初始化字符数组 @done(26-01-28 15:20)
    ✔ char str[] = "hello"; 支持 @done(26-01-28 15:20)
✔ 结构体指定初始化器改进 @done(26-01-28 15:20)
    ✔ 支持嵌套结构体/数组初始化 @done(26-01-28 15:20)
✔ 三元运算符 (? :) - 已修复，支持右结合和嵌套 @done(26-01-28 16:06)
✔ 函数声明检查 @done(26-01-17 12:59)
☐ 添加函数指针变量支持
☐ <<= >>= &= |= ^= += -= *= /= %=
✔ 添加`,`运算符支持 @done(26-01-28 15:15)
☐ 添加对可变参数支持
☐ 添加常用库支持
☐ 添加编译器拓展
    ☐ 常用attribute子项
        ☐ section
        ☐ alias
        ☐ aligned
    ☐ asm指令嵌入支持
☐ 添加typeof语句
☐ 添加typestr语句
☐ 添加defer语句

✔ 完成ast->ssa的braun算法学习 @done(26-01-23 14:54)
✔ 尝试编写单独算法测试模块 @done(26-01-23 14:54)
✔ 参考测试模块编写cc模块的ast转ssa算法代码 @done(26-01-27 15:20)
    ✔ 完成基础架构搭建 @done(26-01-27 15:20)
    ✔ 完成基本块代码编写 @done(26-01-27 15:20)
    ✔ 完成if测试 @done(26-01-27 15:20)
    ✔ 完成while测试 @done(26-01-27 15:20)
    ✔ 完成混合模式测试 @done(26-01-27 15:20)
✔ 优化输出bril格式 @done(26-01-27 16:31)
✔ 创建ssa_pass.c优化框架 @done(26-01-27 16:42)
    ✔ 基础Pass框架 (PassStats, 工具函数) @done(26-01-27 16:42)
    ✔ 添加优化API (ssa_optimize_func, ssa_optimize) @done(26-01-27 16:42)
    ✔ 创建测试文件 test_ssa_opt.c @done(26-01-27 16:42)
    
☐ 完善SSA优化实现
    ✔ 常量折叠 (Constant Folding) - 基础框架 @done(26-01-27 16:50)
    ✔ 死代码消除 (Dead Code Elimination) - 基础框架 @done(26-01-27 16:50)
    ✔ 代数简化 (Algebraic Simplification) - 基础框架 @done(26-01-27 16:50)
    ✔ 强度削弱 (Strength Reduction) - 基础框架 @done(26-01-27 16:50)
    ✔ PHI节点优化 - 基础框架 @done(26-01-27 16:50)
    ☐ 常量传播 (Constant Propagation)
    ☐ 公共子表达式消除 (CSE)
    ☐ Copy传播
    ☐ 控制流优化
    ☐ 循环优化 (LICM等)
    ☐ Use-Def/Def-Use链构建
    ☐ 支配树实现

✔ 创建C51汇编生成器 (c51gen.c) @done(26-01-27 17:03)
    ✔ 线性寄存器分配实现 @done(26-01-27 17:03)
    ✔ 基本指令生成 (MOV, ADD, SUB, MUL, DIV, etc.) @done(26-01-27 17:03)
    ✔ 控制流指令生成 (JMP, BR, CALL, RET) @done(26-01-27 17:03)
    ✔ 比较指令生成 (EQ, NE, LT, GT, etc.) @done(26-01-27 17:03)
    ✔ 创建测试文件 test_c51.c @done(26-01-27 17:03)
    
✔ C51汇编层优化 @done(26-01-27 18:25)
    ✔ 立即数加载优化: MOV A,#0 -> CLR A @done(26-01-27 18:25)
    ✔ 函数入口/出口优化: 普通函数不保存ACC,B,R0-R3 @done(26-01-27 18:25)
    ✔ 常量扫描框架用于优化 @done(26-01-27 18:25)
    ✔ 移除无用函数出口标签和重复RET @done(26-01-27 18:25)
    ✔ 创建汇编优化文档 c51_asm优化.md @done(26-01-27 18:25)
    ☐ 立即数运算优化: ADD A,#1 代替内存加载
    ☐ INC/DEC优化: x+1 -> INC, x-1 -> DEC
    ☐ 比较跳转链优化: 消除中间布尔值转换
    ☐ LJMP → SJMP短跳转优化
    ☐ 窥孔优化: 消除冗余MOV模式
    ☐ 参数传递约定
    ☐ 返回值处理优化
    ☐ 更多8051特殊指令支持

✔ PHI节点处理方案 @done(26-01-27 18:05)
    ✔ 创建PHI处理文档 phi处理说明.md @done(26-01-27 18:05)
    ✔ 实现PHI copy插入算法 @done(26-01-27 18:45)
    ✔ 延迟插入机制（在跳转/返回前插入） @done(26-01-27 18:45)
    ✔ 支持多种MOV模式（寄存器/内存互转） @done(26-01-27 18:45)
    ☐ 处理并行copy问题（需要临时寄存器）
    ☐ 寄存器coalescing优化（消除冗余MOV）

✔ 创建预处理器模块 (pp.c) @done(26-01-28 09:26)
    ✔ #include - 文件包含 @done(26-01-28 09:26)
    ✔ #define - 对象式宏定义 @done(26-01-28 09:26)
    ✔ #define - 函数式宏定义（解析参数） @done(26-01-28 09:26)
    ✔ #undef - 取消宏定义 @done(26-01-28 09:26)
    ✔ #ifdef/#ifndef/#else/#endif - 条件编译 @done(26-01-28 09:26)
    ☐ #if/#elif - 常量表达式条件编译
    ☐ ## 运算符 - 标记粘贴（token pasting）
    ☐ # 运算符 - 字符串化（stringification）
    ☐ 变参宏 - __VA_ARGS__ 支持
    ☐ 预定义宏 - __FILE__, __LINE__, __DATE__, __TIME__
    ☐ #error/#warning - 错误/警告指令
    ☐ #pragma - 编译器指令
    ☐ 宏展开递归保护 - 防止无限递归
    ☐ 函数式宏参数展开 - 当前只解析不展开参数
